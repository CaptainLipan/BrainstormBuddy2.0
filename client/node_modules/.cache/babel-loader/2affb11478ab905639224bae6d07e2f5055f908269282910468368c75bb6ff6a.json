{"ast":null,"code":"var _jsxFileName = \"/Users/honzik/WebstormProjects/BrainstormBuddy2.0/client/src/components/mainbar/posts/Posts.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { getCommentsForPost, postComment, fetchPostsByFilter } from '../../../api/api';\n// Adjust the path based on your project structure\n// Adjust the path based on your project structure\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Posts = ({\n  currentFilter\n}) => {\n  _s();\n  const [posts, setPosts] = useState([]);\n  const [localPost, setLocalPost] = useState(null);\n  const [newCommentText, setNewCommentText] = useState('');\n  const userId = 'user-id'; // Replace with actual user ID\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      try {\n        const filteredPosts = await fetchPostsByFilter(currentFilter);\n        setPosts(Array.isArray(filteredPosts) ? filteredPosts : []);\n      } catch (error) {\n        console.error('Error fetching posts:', error);\n        setPosts([]);\n      }\n    };\n    fetchPosts();\n  }, [currentFilter]); // Re-fetch posts when the filter changes\n\n  const toggleComments = async postId => {\n    const post = posts.find(p => p._id === postId);\n    if (!post) return;\n    if (!post.showComments && post._comments.length === 0) {\n      const comments = await getCommentsForPost(post._id);\n      setLocalPost(prevPost => {\n        if (!prevPost) return null;\n        return {\n          ...prevPost,\n          _comments: comments,\n          showComments: !prevPost.showComments\n        };\n      });\n    } else {\n      setLocalPost(prevPost => {\n        if (!prevPost) return null;\n        return {\n          ...prevPost,\n          showComments: !prevPost.showComments\n        };\n      });\n    }\n  };\n  const handleCommentSubmit = async postId => {\n    if (!localPost || !newCommentText.trim()) return;\n    try {\n      const newComment = await postComment(newCommentText, postId, userId);\n      setLocalPost(prevPost => {\n        if (!prevPost) return null;\n        return {\n          ...prevPost,\n          _comments: [...prevPost._comments, newComment],\n          showComments: true\n        };\n      });\n      setPosts(prevPosts => prevPosts.map(p => p._id === postId ? {\n        ...p,\n        _comments: [...p._comments, newComment]\n      } : p));\n    } catch (error) {\n      console.error('Error posting comment:', error);\n    }\n  };\n  if (!Array.isArray(posts)) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading posts...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 16\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: posts.map(post => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: post.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => toggleComments(post._id),\n        children: post.showComments ? 'Hide Comments' : 'Show Comments'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }, this), post.showComments && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [post._comments.map(comment => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: comment.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            children: comment._creator.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 37\n          }, this)]\n        }, comment._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 33\n        }, this)), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: newCommentText,\n          onChange: e => setNewCommentText(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleCommentSubmit(post._id),\n          children: \"Add Comment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 25\n      }, this)]\n    }, post._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 17\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n};\n_s(Posts, \"Lzvfi6SEG8X2tpAsGdNzNjlUWvM=\");\n_c = Posts;\nexport default Posts;\nvar _c;\n$RefreshReg$(_c, \"Posts\");","map":{"version":3,"names":["React","useState","useEffect","getCommentsForPost","postComment","fetchPostsByFilter","jsxDEV","_jsxDEV","Posts","currentFilter","_s","posts","setPosts","localPost","setLocalPost","newCommentText","setNewCommentText","userId","fetchPosts","filteredPosts","Array","isArray","error","console","toggleComments","postId","post","find","p","_id","showComments","_comments","length","comments","prevPost","handleCommentSubmit","trim","newComment","prevPosts","map","children","fileName","_jsxFileName","lineNumber","columnNumber","title","text","onClick","comment","_creator","username","value","onChange","e","target","_c","$RefreshReg$"],"sources":["/Users/honzik/WebstormProjects/BrainstormBuddy2.0/client/src/components/mainbar/posts/Posts.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { getCommentsForPost, postComment, fetchPostsByFilter } from '../../../api/api';\nimport { Post } from '../../../models/post/PostModel';  // Adjust the path based on your project structure\nimport { CommentData } from '../../../models/comment/CommentModel';  // Adjust the path based on your project structure\n\ninterface PostsProps {\n    currentFilter: string; // Define the type for the prop\n}\n\nconst Posts: React.FC<PostsProps> = ({ currentFilter }) => {\n    const [posts, setPosts] = useState<Post[]>([]);\n    const [localPost, setLocalPost] = useState<Post | null>(null);\n    const [newCommentText, setNewCommentText] = useState('');\n    const userId = 'user-id'; // Replace with actual user ID\n\n    useEffect(() => {\n        const fetchPosts = async () => {\n            try {\n                const filteredPosts = await fetchPostsByFilter(currentFilter);\n                setPosts(Array.isArray(filteredPosts) ? filteredPosts : []);\n            } catch (error) {\n                console.error('Error fetching posts:', error);\n                setPosts([]);\n            }\n        };\n\n        fetchPosts();\n    }, [currentFilter]); // Re-fetch posts when the filter changes\n\n    const toggleComments = async (postId: string) => {\n        const post = posts.find(p => p._id === postId);\n        if (!post) return;\n\n        if (!post.showComments && post._comments.length === 0) {\n            const comments = await getCommentsForPost(post._id);\n            setLocalPost(prevPost => {\n                if (!prevPost) return null;\n                return { ...prevPost, _comments: comments, showComments: !prevPost.showComments };\n            });\n        } else {\n            setLocalPost(prevPost => {\n                if (!prevPost) return null;\n                return { ...prevPost, showComments: !prevPost.showComments };\n            });\n        }\n    };\n\n    const handleCommentSubmit = async (postId: string) => {\n        if (!localPost || !newCommentText.trim()) return;\n\n        try {\n            const newComment: CommentData = await postComment(newCommentText, postId, userId);\n            setLocalPost(prevPost => {\n                if (!prevPost) return null;\n                return {\n                    ...prevPost,\n                    _comments: [...prevPost._comments, newComment],\n                    showComments: true,\n                };\n            });\n\n            setPosts(prevPosts => prevPosts.map(p =>\n                p._id === postId ? { ...p, _comments: [...p._comments, newComment] } : p\n            ));\n        } catch (error) {\n            console.error('Error posting comment:', error);\n        }\n    };\n\n    if (!Array.isArray(posts)) {\n        return <div>Loading posts...</div>;\n    }\n\n    return (\n        <div>\n            {posts.map(post => (\n                <div key={post._id}>\n                    <h2>{post.title}</h2>\n                    <p>{post.text}</p>\n                    <button onClick={() => toggleComments(post._id)}>\n                        {post.showComments ? 'Hide Comments' : 'Show Comments'}\n                    </button>\n                    {post.showComments && (\n                        <div>\n                            {post._comments.map(comment => (\n                                <div key={comment._id}>\n                                    <p>{comment.text}</p>\n                                    <small>{comment._creator.username}</small>\n                                </div>\n                            ))}\n                            <textarea\n                                value={newCommentText}\n                                onChange={(e) => setNewCommentText(e.target.value)}\n                            />\n                            <button onClick={() => handleCommentSubmit(post._id)}>Add Comment</button>\n                        </div>\n                    )}\n                </div>\n            ))}\n        </div>\n    );\n};\n\nexport default Posts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}